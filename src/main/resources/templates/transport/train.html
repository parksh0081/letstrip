<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>êµí†µí¸ ì •ë³´</title>
<style type="text/css">
html, body {
    height: 100%;
    margin: 0;
    display: flex;
    flex-direction: column;
}

header {
    flex-shrink: 0; /* header í¬ê¸° ìœ ì§€ */
}


footer {
    flex-shrink: 0; /* footer í¬ê¸° ìœ ì§€ */
}


body .train-container {
	font-family: Arial, sans-serif;
	text-align: center;
	padding: 20px;
	flex: 1; /* ë©”ì¸ ì½˜í…ì¸ ê°€ ëŠ˜ì–´ë‚  ìˆ˜ ìˆë„ë¡ ì„¤ì • */
}


h2 {
	color: #333;
	font-weight: bold !important;
}

.transbutton {
	width: 150px;
	border: none;
}

.transbutton:hover {
	background-color: #FF9000;
}

#trainForm {
    background: #f4f4f9;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    display: inline-block;
    text-align: left;
    margin-top: 20px;
    margin-bottom: 20px;
    width: 380px;
}

label {
    font-weight: bold;
    margin-top: 10px;
    margin-right: 10px;
}

select {
	margin-left: 10px;
	width: 275px;
	padding: 8px;
	border: 1px solid #ddd;
}

input {
    width: 345px;
    padding: 8px;
    margin: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 16px;
}

.search {
	width: 340px;
	border: 1px solid #ddd;
    border-radius: 5px;
    background-color: #FF9000;
    color: white;
    border: none;
    cursor: pointer;
    font-size: 18px;
    font-weight: bold;
}


#trainResults {
    margin-top: 20px;
}

h5 {
	margin: 10px 0;
	font-weight: bold !important;
	color: #606060 !important;
}

table {
    width: 700px;
    margin: 0 auto;
    border-collapse: separate; 
    border-spacing: 0; 
    background: white;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    border-radius: 5px; 
    overflow: hidden; 
}

th, td {
    padding: 10px;
    border: 1px solid #ddd;
    text-align: center;
}

th {
    background: #FF9000;
    color: white;
}

tr:nth-child(even) {
    background: #f2f2f2;
}

</style>
</head>
<body>
<div th:replace="~{layouts/header}"></div>
	<div class="train-container">
		<h2>Train Schedule</h2>
		<div style="margin-bottom: 10px;">
        	<input type="button" class="transbutton" value="ğŸš— ìì°¨" onclick="location.href='/transport'">
	        <input type="button" class="transbutton" value="ğŸšŒ ë²„ìŠ¤" onclick="location.href='/bus'">
	        <input type="button" class="transbutton" value="ğŸš† ê¸°ì°¨" onclick="location.href='/train'">
        </div>
	    <form id="trainForm">
	    	<div>
	    		<label for="departureCode">ì¶œë°œì§€</label>
		        <select id="departureCode" name="departureCode">
		            <option value="3900587">ê°•ë¦‰</option>
		            <option value="3900229">ê´‘ì£¼ì†¡ì •</option>
		            <option value="3900085">ê¹€ì²œ</option>
		            <option value="3900073">ëŒ€ì „</option>
		            <option value="3900567">ë™ë°±ì‚°</option>
		            <option value="3900096">ë™ëŒ€êµ¬</option>
		            <option value="3900580">ë™í•´</option>
		            <option value="3900686">ë§ˆì‚°</option>
		            <option value="3900242">ëª©í¬</option>
		            <option value="3900621">ë¶€ì „</option>
		            <option value="3900114">ë¶€ì‚°</option>
		            <option value="3900560">ë¶„ì²œ</option>
		            <option value="3900023">ì„œìš¸</option>
		            <option value="3900195">ì„œëŒ€ì „</option>
		            <option value="3901102">ì•ˆë™</option>
		            <option value="3900592">ì•„ìš°ë¼ì§€</option>
		            <option value="3900164">ì˜ì£¼</option>
		            <option value="3900279">ì—¬ìˆ˜EXPO</option>
		            <option value="3900153">ì œì²œ</option>
		            <option value="3900699">ì§„ì£¼</option>
		            <option value="3900565">ì² ì•”</option>
		            <option value="3900388">ì²­ëŸ‰ë¦¬</option>
		            <option value="3900639">íƒœí™”ê°•</option>
		            <option value="3901040">í¬í•­</option>
		            <option value="3900361">í–‰ì‹ </option>
		        </select>
	    	</div>
	    	
	    	<div>
	    		<label for="arrivalCode">ë„ì°©ì§€</label>
		        <select id="arrivalCode" name="arrivalCode">
		            <option value="3900587">ê°•ë¦‰</option>
		            <option value="3900229">ê´‘ì£¼ì†¡ì •</option>
		            <option value="3900085">ê¹€ì²œ</option>
		            <option value="3900073">ëŒ€ì „</option>
		            <option value="3900567">ë™ë°±ì‚°</option>
		            <option value="3900096">ë™ëŒ€êµ¬</option>
		            <option value="3900580">ë™í•´</option>
		            <option value="3900686">ë§ˆì‚°</option>
		            <option value="3900242">ëª©í¬</option>
		            <option value="3900621">ë¶€ì „</option>
		            <option value="3900114">ë¶€ì‚°</option>
		            <option value="3900560">ë¶„ì²œ</option>
		            <option value="3900023">ì„œìš¸</option>
		            <option value="3900195">ì„œëŒ€ì „</option>
		            <option value="3901102">ì•ˆë™</option>
		            <option value="3900592">ì•„ìš°ë¼ì§€</option>
		            <option value="3900164">ì˜ì£¼</option>
		            <option value="3900279">ì—¬ìˆ˜EXPO</option>
		            <option value="3900153">ì œì²œ</option>
		            <option value="3900699">ì§„ì£¼</option>
		            <option value="3900565">ì² ì•”</option>
		            <option value="3900388">ì²­ëŸ‰ë¦¬</option>
		            <option value="3900639">íƒœí™”ê°•</option>
		            <option value="3901040">í¬í•­</option>
		            <option value="3900361">í–‰ì‹ </option>
		        </select>
	    	</div>
	    	
	
	        <div>
	        	<label for="departureDate">ë‚ ì§œ</label>
	        	<input type="text" id="departureDate" name="departureDate" required><br><br>
	        </div>
	       
	        
	        <button type="submit" class="search">ì¡°íšŒ</button>
	    </form>
	
	    <div id="trainResults"></div>
	</div>
    

    <script>
        document.getElementById("trainForm").addEventListener("submit", function(event) {
            event.preventDefault();  // ê¸°ë³¸ í¼ ì œì¶œ ë°©ì§€

            const departureDate = document.getElementById("departureDate").value.replace(/-/g, "");
            const departureCode = document.getElementById("departureCode").value;
            const arrivalCode = document.getElementById("arrivalCode").value;
           

            // Fetchë¥¼ ì´ìš©í•´ ë°ì´í„° ìš”ì²­
            fetch(`/trainSchedule?departureDate=${departureDate}
            &departureCode=${departureCode}
            &arrivalCode=${arrivalCode}
            `)
                .then(response => response.json())
                .then(data => {
                    console.log(data); // ì‘ë‹µ ë°ì´í„°ë¥¼ ì½˜ì†”ì— ì¶œë ¥
                    displayTrainSchedule(data);
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        });
        

        function displayTrainSchedule(data) {
            const resultsDiv = document.getElementById("trainResults");

            if (data.response.body.items.item.length > 0) {
                let htmlContent = `
                    <h5>ğŸš† ê¸°ì°¨ ê²½ë¡œ ì¡°íšŒ</h5>
                    <table border="1">
                        <thead>
                            <tr>
                                <th>Train No</th>
                                <th>ì¶œë°œì§€</th>
                                <th>ë„ì°©ì§€</th>
                                <th>ë‚ ì§œ</th>
                                <th>ì¶œë°œì‹œê°„</th>
                                <th>ë„ì°©ì‹œê°„</th>
                            </tr>
                        </thead>
                        <tbody>
                `;

                data.response.body.items.item.forEach(item => {
                    let formattedDate = `${item.run_ymd.substring(0, 4)}-${item.run_ymd.substring(4, 6)}-${item.run_ymd.substring(6, 8)}`;
                    let departureTime = item.trn_plan_dptre_dt.split(" ")[1].substring(0, 5); // HH:mm í˜•ì‹
                    let arrivalTime = item.trn_plan_arvl_dt.split(" ")[1].substring(0, 5); // HH:mm í˜•ì‹

                    htmlContent += `
                        <tr>
                            <td>${item.trn_no}</td>
                            <td>${item.dptre_stn_nm}</td>
                            <td>${item.arvl_stn_nm}</td>
                            <td>${formattedDate}</td>
                            <td>${departureTime}</td>
                            <td>${arrivalTime}</td>
                        </tr>
                    `;
                });

                htmlContent += `
                        </tbody>
                    </table>
                    <!-- ê¸°ì°¨ ì˜ˆë§¤ ë§í¬ -->
                    <div style="margin-top: 20px;">
                        <a href="https://www.korail.com" target="_blank" style="color: #FF9000; font-size: 16px; font-weight: bold;">ê¸°ì°¨ ì˜ˆë§¤í•˜ê¸°</a>
                    </div>
                `;

                resultsDiv.innerHTML = htmlContent;
            } else {
                resultsDiv.innerHTML = "<p>ğŸš¨ í•´ë‹¹ ì¡°ê±´ì— ë§ëŠ” ê¸°ì°¨ê°€ ì—†ìŠµë‹ˆë‹¤..</p>";
            }
        }

    </script>
<div th:replace="~{layouts/footer}"></div>
</body>
</html>
